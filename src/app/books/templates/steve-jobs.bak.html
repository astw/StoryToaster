
<script type="text/javascript" src="/js/steve-jobs/extras/jquery.min.1.7.js"></script>
<script type="text/javascript" src="/js/steve-jobs/extras/jquery-ui-1.8.20.custom.min.js"></script>
<script type="text/javascript" src="/js/steve-jobs/extras/jquery.mousewheel.min.js"></script>
<script type="text/javascript" src="/js/steve-jobs/extras/modernizr.2.5.3.min.js"></script>
<script type="text/javascript" src="/js/steve-jobs/lib/hash.js"></script>

<div id="canvas">
	<div id="book-zoom">
    <div class="sj-book">

      <div depth="5" class="hard"> <div class="side"></div> </div>
      <div depth="5" class="hard front-side"> <div class="depth"></div> </div>

      <page data="book.frontCover" id=0 />
      <div class="hard" ng-repeat="page in pages">
        <page data="page" id= page.index />
      </div>

      <div class="own-size" style="width: 460px; height: 600px;">this is ownsize page</div>
      <div class="own-size even" id="p4" style="width: 460px; height: 600px; color: transparent;">
        this is 怕 平
      </div>

      <div class="own-size" id="p5" style="width: 460px; height: 600px; color: transparent;">
        this is p5
      </div>
      <!-- <div class="own-size even" style="background-color:#F00;"></div>  -->
      <div class="own-size even even p6" style="width: 460px; height: 600px;">
        dddd
      </div>

      <div class="own-size p7" style="width: 460px; height: 600px;">
        dddd
      </div>

      <div class="own-size even p8" style="width: 460px; height: 600px;">
        dddd
      </div>

      <div class="hard fixed back-side p9"> <div class="depth"></div> </div>
      <div class="hard p10"></div>
    </div>
	</div>
</div>

<script type="text/javascript">

    function loadApp() {

      var flipbook = $('.sj-book');

      // Check if the CSS was already loaded
      if (flipbook.width()==0 || flipbook.height()==0) {
        setTimeout(loadApp, 10);
        return;
      }

      flipbook.turn({
        elevation: 50,
        width:952,
        height:630,
        acceleration: !isChrome(),
        autoCenter: true,
        gradients: true,
        duration: 1000,
        pages: 10,
        when: {
          turning: function(e, page, view) {

            var book = $(this),
              currentPage = book.turn('page'),
              pages = book.turn('pages');

            if (currentPage>3 && currentPage<pages-3) {

              if (page==1) {
                book.turn('page', 2).turn('stop').turn('page', page);
                e.preventDefault();
                return;
              } else if (page==pages) {
                book.turn('page', pages-1).turn('stop').turn('page', page);
                e.preventDefault();
                return;
              }
            } else if (page>3 && page<pages-3) {
              if (currentPage==1) {
                book.turn('page', 2).turn('stop').turn('page', page);
                e.preventDefault();
                return;
              } else if (currentPage==pages) {
                book.turn('page', pages-1).turn('stop').turn('page', page);
                e.preventDefault();
                return;
              }
            }

            updateDepth(book, page);

            if (page>=2)
              $('.sj-book .p2').addClass('fixed');
            else
              $('.sj-book .p2').removeClass('fixed');

            if (page<book.turn('pages'))
              $('.sj-book .p9').addClass('fixed');
            else
              $('.sj-book .p9').removeClass('fixed');

          },

          turned: function(e, page, view) {

            var book = $(this);

            if (page==2 || page==3) {
              book.turn('peel', 'br');
            }

            updateDepth(book);

            $('#slider').slider('value', getViewNumber(book, page));

            book.turn('center');

          },

          end: function(e, pageObj) {

            var book = $(this);

            updateDepth(book);
          }
        }
      });



      flipbook.addClass('animated');

      // Show canvas
      $('#canvas').css({visibility: ''});
    }

    // Hide canvas

    $('#canvas').css({visibility: 'hidden'});

    // Load turn.js

    yepnope({
      test : Modernizr.csstransforms,
      yep: ['/js/steve-jobs/lib/turn.min.js'],
      nope: ['/js/steve-jobs/lib/turn.html4.min.js', '/js/steve-jobs/css/jquery.ui.html4.css', '/js/steve-jobs/css/steve-jobs-html4.css'],
      both: ['js/steve-jobs/js/steve-jobs.js', '/js/steve-jobs/css/jquery.ui.css', '/js/steve-jobs/css/steve-jobs.css'],
      complete: loadApp
    });


  </script>
